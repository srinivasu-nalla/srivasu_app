<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Srivasu</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.8/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <title>YouTube Shorts from Channel</title>
    <style>
        .shorts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .short-container iframe { width: 100%; height: 400px; border-radius: 12px; }
    </style>
</head>
<body>
    <h1>Latest Shorts</h1>
    <div id="shorts-container" class="shorts-grid"></div>

    <script>
        const API_KEY = 'AIzaSyCQgiP8AoygY2XyJjXi_JXuqEvWfDm06Jw';
        const CHANNEL_ID = 'UCPUbemzeY9MH3PUtq8p47qw';  // e.g., from channel URL

        async function loadShorts() {
            try {
                // Step 1: Get uploads playlist ID [web:13]
                const channelRes = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`);
                const channelData = await channelRes.json();
                const uploadsPlaylistId = channelData.items[0].contentDetails.relatedPlaylists.uploads;

                // Step 2: Get latest 50 videos from uploads [web:13]
                const playlistRes = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${uploadsPlaylistId}&maxResults=50&key=${API_KEY}`);
                const playlistData = await playlistRes.json();
                
                const container = document.getElementById('shorts-container');
                container.innerHTML = '';

                // Step 3: Filter and embed Shorts (≤60s via API duration check or URL heuristic) [web:7][web:15]
                for (let item of playlistData.items) {
                    const videoId = item.snippet.resourceId.videoId;
                    const title = item.snippet.title;
                    
                    // Fetch video details to check duration ≤60s for Shorts [web:7]
                    const videoRes = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=contentDetails&id=${videoId}&key=${API_KEY}`);
                    const videoData = await videoRes.json();
                    const duration = videoData.items[0]?.contentDetails.duration;  // e.g., "PT28S"
                    const seconds = parseDuration(duration);
                    
                    if (seconds <= 200) {
                        const embedHtml = `
                            <div class="short-container">
                                <h3>${title}</h3>
                                <iframe src="https://www.youtube.com/embed/${videoId}?rel=0" frameborder="0" allowfullscreen></iframe>
                            </div>
                        `;
                        container.innerHTML += embedHtml;
                    }
                }
            } catch (error) {
                console.error('Error loading Shorts:', error);
                document.getElementById('shorts-container').innerHTML = '<p>Failed to load Shorts. Check API key and channel ID.</p>';
            }
        }

        function parseDuration(isoDuration) {
            const matches = isoDuration.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);
            const hours = parseInt(matches[1]) || 0;
            const minutes = parseInt(matches[2]) || 0;
            const seconds = parseInt(matches[3]) || 0;
            return hours * 3600 + minutes * 60 + seconds;
        }

        loadShorts();  // Auto-load on page
    </script>
</body>
</html>
